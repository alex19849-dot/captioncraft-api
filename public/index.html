Woah hang on the go pro button is still showing on the front app! This is the current api code <!doctype html> <html lang="en"> <head> <meta charset="utf-8" /> <title>PostPoet ‚Äì AI Caption Generator</title> <meta name="viewport" content="width=device-width, initial-scale=1" /> <style> :root{ --bg:#0f1115; --card:#171a21; --muted:#8b95a7; --line:#2f3852; --text:#e8ecf1; --accent:#67d8f4; } *{box-sizing:border-box} body{ margin:0; font-family:system-ui,sans-serif; background:#0f1115; color:#e8ecf1; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; min-height:100vh; padding-top:30px; } .card{ width:100%; max-width:900px; background:var(--card); border:1px solid var(--line); border-radius:16px; padding:22px; box-shadow:0 10px 36px rgba(0,0,0,.45); } h1{margin:0 0 8px; text-align:center; color:var(--accent)} .sub{margin:0 0 18px; text-align:center; color:var(--muted); font-size:14px} label{display:block; margin:12px 0 6px; color:var(--muted); font-size:14px} textarea,input,select,button{ width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--line); background:#0e121a; color:var(--text); font-size:14px; } /* BRAND TITLE */ /* BRAND MARK */ #brandTitle{ font-family: Inter, system-ui, sans-serif; font-size:38px; font-weight:900; color:#e8ecf1; letter-spacing:0.5px; text-align:center; display:inline-block; position:relative; margin:0 auto 20px auto; left:50%; transform:translateX(-50%); padding:0; } /* Ps */ #brandTitle .pBlue{ color:#6ee7ff; } /* underline clean + thin + full reach + baseline */ #brandTitle::after{ content:""; position:absolute; height:3px; width:100%; left:50%; transform:translateX(-50%); bottom:-3px; background:#6ee7ff; pointer-events:none; } } /* cyan Ps */ #brandTitle .pBlue{ color:#6ee7ff; } /* mobile tune */ @media (max-width:540px){ #brandTitle{ font-size:32px; margin-bottom:18px; } #brandTitle::after{ height:6px; width:72%; bottom:-6px; } } .ppP{ color:#6ee7ff; } select{cursor:pointer} .row{display:grid; gap:12px} @media(min-width:720px){ .row{grid-template-columns:2fr 1fr} } button.primary{ margin-top:14px; font-weight:700; cursor:pointer; background:linear-gradient(180deg,#1b2640,#121a2d); box-shadow:0 4px 12px rgba(84,164,255,.18); } .meta{display:flex; gap:10px; align-items:center; margin-top:8px; font-size:13px; color:var(--muted)} .badge{display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:4px 8px; border:1px solid var(--line); border-radius:999px; color:var(--muted)} .pro{border-color:#3aa471; color:#87e4a5} .danger{color:#ff6b6b} #outputs{margin-top:20px; display:grid; gap:10px} .out{background:#0f1420; border:1px solid #232838; border-radius:12px; padding:10px} .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px} .lock{opacity:.55; cursor:not-allowed} .tooltip{font-size:12px; color:var(--muted)} .input-wrap{ position:relative; } .input-wrap{ position:relative; } /* Give the textarea room for the icon on the right */ .input-wrap textarea{ padding-right:44px; /* space for mic */ } /* Override the global button styles for the mic */ .mic-icon{ position:absolute; right:12px; top:50%; transform:translateY(-50%); width:28px; /* stop it being full width */ height:28px; display:flex; /* center the svg in this square */ align-items:center; justify-content:center; background:none; border:none; cursor:pointer; opacity:.8; padding:0; line-height:1; color:var(--accent); z-index:2; } .mic-icon:active{ opacity:1; scale:0.96; } /* Modal */ .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:9999; } .modal{background:#121621; border:1px solid var(--line); border-radius:14px; width:min(520px,92%); padding:18px} .modal h3{margin:6px 0 8px; color:var(--accent)} .modal p{margin:0 0 12px; color:var(--muted)} .modal .row{grid-template-columns:1fr auto} .modal .btn{padding:10px 14px; border-radius:10px; border:1px solid var(--line); background:#182032; color:#fff; cursor:pointer; font-weight:700} .modal .btn.secondary{background:#22283a} .center{display:flex; justify-content:center} @media(min-width:720px) and (max-width:980px){ .row{ gap:20px; } .card{ padding:20px 26px; } } @media(min-width:981px){ .card{ max-width:780px; } } @media(max-width:540px){ body{ padding-top:14px; } .card{ padding:16px; border-radius:14px; } nav{ font-size:11px; gap:16px; margin-bottom:18px; } h1{ margin-bottom:4px; font-size:22px; } .sub{ margin-bottom:12px; font-size:13px; } textarea,input,select,button{ padding:8px 10px; font-size:13px; } .actions{ gap:8px; margin-top:6px; } #outputs{ margin-top:14px; gap:8px; } footer{ margin-top:26px; font-size:11px; } } @media(max-width:540px){ .modal{ padding:14px !important; } .modal h3{ font-size:16px; } .modal p{ font-size:12px; } } @media(max-width:540px){ .mobile-sub-brand { margin-bottom:18px !important; font-size:12px !important; opacity:.75; } } /* FORCE BRAND TITLE OVERRIDE FINAL */ #brandTitle{ font-family: Inter, system-ui, sans-serif !important; font-size:34px !important; font-weight:900 !important; line-height:1.1 !important; color:#e8ecf1 !important; text-align:center !important; display:inline-block !important; position:relative !important; left:50% !important; transform:translateX(-50%) !important; margin:0 auto 12px auto !important; padding:0 !important; letter-spacing:1px !important; } #brandTitle .pBlue{ color:#6ee7ff !important; } #brandTitle::after{ content:""; position:absolute !important; width:100% !important; height:2px !important; left:50% !important; transform:translateX(-50%) !important; bottom:-3px !important; background:#6ee7ff !important; } </style> </head> <body> <nav style="width:100%;display:flex;justify-content:center;gap:30px;margin-bottom:30px;font-size:13px;"> <a href="#" id="manageBilling" style="color:#6ee7ff;text-decoration:none;display:none;">Manage Billing</a> <a href="#" id="contactLink" style="color:#6ee7ff;text-decoration:none;">Contact</a> <a href="#" id="logoutLink" style="color:#6ee7ff;text-decoration:none;">Logout</a> </nav> <div style="margin-bottom:30px;font-size:13px;color:#8b95a7;text-align:center;"> PostPoet makes your captions hit different. </div> <div class="mobile-sub-brand" style="width:100%;padding:10px 0;text-align:center;font-size:13px;color:#8b95a7;"> PostPoet is for modern storytellers. You get 10 free creations a day. Pro removes the limits. </div> <div class="card"> <h1 id="brandTitle"><span class="pBlue">P</span>ost<span class="pBlue">P</span>oet</h1> <p class="sub" style="margin-top:10px;">AI built for creators who actually have taste. ...</p> <p class="sub">AI built for creators who actually have taste. Say more in less words, get more reach with less effort.</p> <p class="sub" style="margin-top:6px;color:#6ee7ff;font-size:13px;opacity:.8;">Designed for the ones who know how the culture moves, not the algorithm.</p> <div class="row"> <div> <label for="desc">Tell PostPoet what‚Äôs happening in the photo and choose a tone. It will turn that into 5 ready-to-post captions.</label> <div class="input-wrap"> <textarea id="desc" rows="4" placeholder="Example: pint of lager in a sunny pub garden..."></textarea> <button id="micBtn" class="mic-icon" aria-label="Hold to speak" title="Pro only"> <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 14a3 3 0 0 0 3-3V5a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3zm5-3a5 5 0 0 1-10 0H5a7 7 0 0 0 14 0h-2zm-5 7a7 7 0 0 0 7-7h2a9 9 0 0 1-8 8.95V22h-2v-2.05A9 9 0 0 1 3 11h2a7 7 0 0 0 7 7z"/></svg> </button> </div> </div> <div> <label for="tone">Tone</label> <select id="tone"> <option>witty</option> <option>bold</option> <option>laid-back</option> <option>Product selling direct</option> <option>Sarcastic</option> <option>Luxury</option> <option>Motivational</option> <option>Flirty</option> <option>Dark humour</option> <option>Empathetic supportive</option> <option>Melancholic reflective</option> <option>Savage roast</option> </select> <label for="style">Style Length</label> <select id="style"> <option value="short">Punchy Short</option> <option value="medium" selected>Normal Caption</option> <option value="long">Story Mode</option> </select> <div class="actions"> <button id="generate" class="primary">Generate captions</button> </div> <div class="tooltip" id="proNote">Voice mode counts as a use. Pro removes the limit.</div> <div class="meta"> <span id="limitInfo"></span> <span id="statusBadge" class="badge">Status: Checking‚Ä¶</span> </div> <button id="goPro" style="margin-top:14px;background:#202532;border:1px solid #3a4156;border-radius:10px;padding:12px 16px;font-weight:600;cursor:pointer;color:#e8ecf1;"> Unlock Pro ‚Äì unlimited captions, ¬£4.99/month </button> </div> </div> <div id="outputs"></div> </div> <!-- Email modal --> <div class="modal-backdrop" id="emailModal"> <div class="modal"> <h3>Quick thing, what‚Äôs your email?</h3> <p>We‚Äôll use this to check your Pro status. No spam, pinky promise.</p> <div class="row"> <input id="emailInput" type="email" placeholder="you@example.com" /> <button id="saveEmail" class="btn">Save</button> </div> <div class="center" style="margin-top:8px;"> <button id="skipEmail" class="btn secondary">Skip for now</button> </div> </div> </div> <div class="modal-backdrop" id="contactModal"> <div class="modal"> <h3>Contact Support</h3> <p>You can reach the PostPoet support team at:</p> <p style="color:#6ee7ff;font-size:15px;margin:8px 0;">postpoet.info@gmail.com</p> <div class="center" style="margin-top:12px;"> <button id="closeContact" class="btn secondary">Close</button> </div> </div> </div> <footer style="width:100%;text-align:center;margin-top:40px;margin-bottom:20px;font-size:12px;"> <a href="/privacy.html" style="color:#6ee7ff;text-decoration:none;margin:0 10px;">Privacy</a> <a href="/terms.html" style="color:#6ee7ff;text-decoration:none;margin:0 10px;">Terms</a> <a href="/faq.html" style="color:#6ee7ff;text-decoration:none;margin:0 10px;">FAQ</a> <a href="/about.html" style="color:#6ee7ff;text-decoration:none;margin:0 10px;">About</a> </footer> <script> "use strict"; /* =============== CONFIG =============== */ const DAILY_LIMIT = 10; // shared pool: mic + text const CHECK_URL = "https://postpoet-api.vercel.app/api/check"; const GENERATE_URL = "https://postpoet-api.vercel.app/api/generate"; const STRIPE_LINK = "https://buy.stripe.com/5kQ4gyeFb5B4bZDb118Zq00"; /* =============== STATE + DOM =============== */ let isPro = false; let email = localStorage.getItem("cc_email") || ""; let lastKnownPro = localStorage.getItem("lastKnownPro") === "true"; const $ = (id) => document.getElementById(id); const limitInfo = $("limitInfo"); const statusBadge = $("statusBadge"); const outputs = $("outputs"); const micBtn = $("micBtn"); const goProBtn = $("goPro"); const modal = $("emailModal"); const emailInput = $("emailInput"); const saveEmail = $("saveEmail"); const skipEmail = $("skipEmail"); const descEl = $("desc"); const toneEl = $("tone"); const generateBtn = $("generate"); const proNote = $("proNote"); const logoutLink = $("logoutLink"); const manageBilling= $("manageBilling"); const contactLink = $("contactLink"); const contactModal = $("contactModal"); const closeContact = $("closeContact"); /* =============== USAGE (mic + text share 10) =============== */ function getUsage(){ const today = new Date().toISOString().slice(0,10); const record = JSON.parse(localStorage.getItem("captionUsageShared") || "{}"); if (record.date !== today) return { date: today, used: 0 }; return record; } function saveUsage(data){ localStorage.setItem("captionUsageShared", JSON.stringify(data)); } function canUse(){ return isPro ? true : getUsage().used < DAILY_LIMIT; } function recordUse(){ if (!isPro) { const d = getUsage(); d.used += 1; saveUsage(d); updateLimitDisplay(); } } function updateLimitDisplay(){ const d = getUsage(); if (limitInfo) limitInfo.textContent = Free credits left today: ${Math.max(0, DAILY_LIMIT - d.used)} / ${DAILY_LIMIT}; } /* =============== UI APPLY (Pro/Free + nav gating) =============== */ function applyUIForPro(){ const legacyPro = micBtn?.querySelector?.(".pro"); if (legacyPro) legacyPro.remove(); if (micBtn){ micBtn.classList.remove("lock"); micBtn.title = isPro ? "Hold to speak your idea, release to stop" : "Hold to speak, counts toward your free daily limit"; } if (isPro) { if (statusBadge) statusBadge.textContent = "Status: Pro ‚úÖ"; if (limitInfo) limitInfo.textContent = "Unlimited generations"; if (goProBtn) goProBtn.style.display = "none"; if (manageBilling) manageBilling.style.display = "inline"; } else { if (statusBadge) statusBadge.textContent = "Status: Free"; updateLimitDisplay(); if (goProBtn) goProBtn.style.display = "block"; if (manageBilling) manageBilling.style.display = "none"; } if (logoutLink) logoutLink.style.display = email ? "inline" : "none"; if (proNote) { proNote.style.display = isPro ? "none" : "block"; proNote.textContent = "Mic and captions share 10 free uses per day. Pro unlocks unlimited."; } } /* =============== PRO STATUS (optimistic, no flick) =============== */ async function refreshProStatus(){ try { if (!email) { isPro = false; localStorage.setItem("lastKnownPro", "false"); applyUIForPro(); return; } const r = await fetch(CHECK_URL + "?email=" + encodeURIComponent(email), { method: "GET", headers: { "Accept":"application/json" } }); if (!r.ok) { if (isPro === false) localStorage.setItem("lastKnownPro", "false"); applyUIForPro(); console.warn("pro check failed", r.status); return; } const data = await r.json(); const newState = !!(data && data.pro); if (newState !== isPro) { isPro = newState; localStorage.setItem("lastKnownPro", String(isPro)); if (statusBadge) statusBadge.textContent = isPro ? "Status: Pro ‚úÖ" : "Status: Free"; applyUIForPro(); } } catch (err) { console.error("refreshProStatus error", err); } } /* =============== EMAIL MODAL (capture) =============== */ function openModal(){ if (modal) modal.style.display = "flex"; } function closeModal(){ if (modal) modal.style.display = "none"; } function persistEmail(v){ email = (v || "").trim(); if (email) localStorage.setItem("cc_email", email); } if (!email) openModal(); if (saveEmail) saveEmail.addEventListener("click", async () => { const v = emailInput?.value.trim(); if (!v || !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(v)) { alert("Pop a valid email in."); return; } persistEmail(v); closeModal(); await refreshProStatus(); }); if (skipEmail) skipEmail.addEventListener("click", () => { closeModal(); updateLimitDisplay(); if (statusBadge) statusBadge.textContent = "Status: Guest (not Pro)"; }); /* =============== SPEECH TO TEXT (free until pool spent) =============== */ let recognition = null; if ("webkitSpeechRecognition" in window) { recognition = new webkitSpeechRecognition(); recognition.continuous = false; recognition.interimResults= false; recognition.lang = "en-GB"; let buffer = ""; let listening = false; function startMic(e) { if (e) e.preventDefault(); if (!isPro && !canUse()) { alert("You‚Äôve used your free actions today. Go Pro for unlimited."); return; } if (listening) return; buffer = ""; listening = true; outputs.insertAdjacentHTML("afterbegin", <div class="out" id="live">üéôÔ∏è Listening‚Ä¶ speak your idea</div>); try { recognition.start(); } catch (_) {} } function stopMic(e) { if (e) e.preventDefault(); if (!listening) return; try { recognition.stop(); } catch (_) {} } if (micBtn){ // Desktop press/hold micBtn.addEventListener("mousedown", startMic, { passive: false }); micBtn.addEventListener("mouseup", stopMic, { passive: false }); micBtn.addEventListener("mouseleave",stopMic, { passive: false }); // Mobile press/hold micBtn.addEventListener("touchstart", startMic, { passive: false }); micBtn.addEventListener("touchend", stopMic, { passive: false }); micBtn.addEventListener("touchcancel",stopMic, { passive: false }); // Single tap toggle micBtn.addEventListener("click", (e) => { if (!listening) startMic(e); else stopMic(e); }); } recognition.onresult = (event) => { for (let i = event.resultIndex; i < event.results.length; i++) { if (event.results[i].isFinal) { buffer += (buffer ? " " : "") + event.results[i][0].transcript; } } const live = document.getElementById("live"); if (live) live.textContent = "üéôÔ∏è " + (buffer || "Listening‚Ä¶"); }; recognition.onerror = () => { listening = false; const live = document.getElementById("live"); if (live) live.remove(); }; recognition.onend = () => { listening = false; const live = document.getElementById("live"); if (live) live.remove(); const text = (buffer || "").trim(); if (text) { recordUse(); descEl.value = (descEl.value ? descEl.value + " " : "") + text; } }; } else { if (micBtn) micBtn.title = "Speech to text not supported in this browser"; } /* ========================= GENERATE CAPTIONS (server) ========================= */ generateBtn.addEventListener("click", async () => { const desc = (descEl.value || "").trim(); const tone = toneEl.value; const style = (document.getElementById("style")?.value) || "medium"; if (!desc) { alert("Write a quick description first."); return; } if (!isPro && !canUse()) { alert("You‚Äôve used your free captions today. Go Pro for unlimited."); return; } outputs.innerHTML = "<div class='out'>Thinking up captions‚Ä¶</div>"; try { const r = await fetch(GENERATE_URL, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ desc, tone, style, email }) }); if (!r.ok) { const t = await r.text(); throw new Error(API ${r.status}: ${t}); } const { captions, promptVersion } = await r.json(); console.log("PromptVersion:", promptVersion); recordUse(); outputs.innerHTML = ""; captions.forEach(line => { const pill = document.createElement("button"); pill.textContent = line; pill.className = "pillCopy"; pill.style.cssText = "display:block;width:100%;text-align:left;background:#181f2d;border:1px solid #2e364b;border-radius:8px;padding:10px;margin-bottom:8px;color:#e8ecf1;cursor:pointer;font-size:14px;"; pill.style.whiteSpace = "normal"; pill.style.wordBreak = "break-word"; pill.addEventListener("click", () => { navigator.clipboard.writeText(line); pill.style.borderColor="#6ee7ff"; pill.style.background="#112030"; pill.textContent="Copied ‚úÖ"; setTimeout(()=>{ pill.textContent=line; pill.style.borderColor="#2e364b"; pill.style.background="#181f2d"; },900); }); outputs.appendChild(pill); }); } catch (e) { outputs.innerHTML = <div class="out" style="color:#ff6b6b">Error: ${e.message}</div>; console.error(e); } }); /* =============== NAV ACTIONS (Go Pro, Logout, Billing, Contact) =============== */ if (goProBtn) goProBtn.addEventListener("click", () => { window.location.href = STRIPE_LINK; }); if (logoutLink) logoutLink.addEventListener("click", (e) => { e.preventDefault(); localStorage.removeItem("cc_email"); localStorage.removeItem("lastKnownPro"); localStorage.removeItem("captionUsageShared"); window.location.reload(); }); if (manageBilling) manageBilling.addEventListener("click", (e) => { e.preventDefault(); window.location.href = "https://billing.stripe.com/p/login/5kQ4gyeFb5B4bZDb118Zq00"; }); if (contactLink) contactLink.addEventListener("click", (e) => { e.preventDefault(); if (contactModal) contactModal.style.display = "flex"; }); if (closeContact) closeContact.addEventListener("click", () => { if (contactModal) contactModal.style.display = "none"; }); /* =============== BOOT =============== */ (function boot(){ try { if (email && emailInput) emailInput.value = email; if (micBtn) micBtn.classList.remove("lock"); updateLimitDisplay(); isPro = lastKnownPro; if (statusBadge) statusBadge.textContent = isPro ? "Status: Pro ‚úÖ" : "Status: Free"; applyUIForPro(); refreshProStatus(); } catch (e) { console.error("boot error", e); } })(); /* =============== RETURN FROM STRIPE / TAB FOCUS =============== */ document.addEventListener("visibilitychange", ()=>{ if (document.visibilityState === "visible") refreshProStatus(); }); </script> </body> </html>
